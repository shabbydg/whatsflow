# WhatsFlow API - Quick Start Guide

Get started with the WhatsFlow Public API in under 5 minutes!

## ğŸ“‹ Prerequisites

- âœ… WhatsFlow account with active subscription
- âœ… At least one connected WhatsApp device
- âœ… Access to WhatsFlow dashboard

---

## Step 1: Create an API Key (2 minutes)

1. **Login to WhatsFlow**
   ```
   http://localhost:2153
   ```

2. **Navigate to API Keys**
   - Click **Settings** in the sidebar
   - Click **API Keys**

3. **Create New Key**
   - Click "Create API Key" button
   - Enter a name: `My First API Key`
   - Select environment: `Live`
   - Select scopes:
     - âœ… `messages:send`
     - âœ… `messages:read`
     - âœ… `devices:read`
   - Click "Create API Key"

4. **Save Your Key**
   - âš ï¸ **IMPORTANT:** Copy the key immediately - it's shown only once!
   - It looks like: `wf_live_abc123xyz789...`
   - Store it securely

---

## Step 2: Test Your API Key (1 minute)

Open your terminal and run:

```bash
# Set your API key
export API_KEY="wf_live_your_key_here"

# Test: List your devices
curl -H "Authorization: Bearer $API_KEY" \
     http://localhost:2152/api/public/v1/devices
```

**Expected output:**
```json
{
  "success": true,
  "data": [
    {
      "id": "device_abc123",
      "device_name": "Main Line",
      "status": "connected",
      ...
    }
  ]
}
```

---

## Step 3: Send Your First Message (1 minute)

```bash
curl -X POST http://localhost:2152/api/public/v1/messages/send \
  -H "Authorization: Bearer $API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "phone_number": "+94771234567",
    "message": "Hello from WhatsFlow API! ğŸš€"
  }'
```

**Expected output:**
```json
{
  "success": true,
  "data": {
    "message_id": "msg_xyz789",
    "phone_number": "+94771234567",
    "status": "sent",
    "timestamp": "2025-10-11T10:30:00.000Z"
  }
}
```

âœ… **Success!** You've sent your first message via the API!

---

## Step 4: Use the SDK (1 minute)

### Node.js

```javascript
// Copy nodejs-sdk.js to your project
const WhatsFlowAPI = require('./nodejs-sdk');

const api = new WhatsFlowAPI('wf_live_your_key_here');

// Send message
const result = await api.sendMessage('+94771234567', 'Hello!');
console.log('âœ… Message sent:', result.message_id);

// List devices
const devices = await api.listDevices();
console.log('ğŸ“± Devices:', devices.length);
```

### Python

```python
# Copy python-sdk.py to your project
from whatsflow_sdk import WhatsFlowAPI

api = WhatsFlowAPI('wf_live_your_key_here')

# Send message
result = api.send_message('+94771234567', 'Hello!')
print(f"âœ… Message sent: {result['message_id']}")

# List devices
devices = api.list_devices()
print(f"ğŸ“± Devices: {len(devices)}")
```

---

## Next Steps

### ğŸ“– Read the Documentation
- Interactive docs: http://localhost:2153/docs
- API Reference: `/whatsflow/backend/API_PUBLIC_REFERENCE.md`

### ğŸ”” Set Up Webhooks
- Go to: Settings â†’ Webhooks
- See: `/whatsflow/backend/examples/webhook-server-express.js`
- Guide: http://localhost:2153/docs/webhooks

### ğŸ”‘ Manage API Keys
- View usage: Settings â†’ API Keys
- Create additional keys with different scopes
- Rotate keys regularly for security

### ğŸ“Š Monitor Usage
- Check rate limits in API responses
- View request logs in API Keys page
- Monitor webhook deliveries

---

## Common Use Cases

### 1. Send Invoice Reminders

```javascript
const api = new WhatsFlowAPI('wf_live_xxx');

async function sendInvoiceReminder(customer) {
  await api.sendMessage(
    customer.phone,
    `Hi ${customer.name}, invoice #${customer.invoiceId} is due on ${customer.dueDate}.`
  );
}
```

### 2. Receive Customer Messages

```javascript
// webhook-handler.js
app.post('/webhooks/whatsflow', verifySignature, async (req, res) => {
  if (req.body.event === 'message.received') {
    const { phone_number, message } = req.body.data;
    await logToYourCRM(phone_number, message);
  }
  res.status(200).send('OK');
});
```

### 3. Monitor Device Status

```javascript
const devices = await api.listDevices();
const disconnected = devices.filter(d => d.status === 'disconnected');

if (disconnected.length > 0) {
  console.log('âš ï¸  Disconnected devices:', disconnected);
  // Send admin alert
}
```

---

## Troubleshooting

### âŒ "Invalid API key"
- Check key starts with `wf_live_` or `wf_test_`
- Verify key is active in Settings â†’ API Keys
- Ensure no extra spaces in Authorization header

### âŒ "Insufficient permissions"
- Check API key has required scope
- Update key scopes in Settings â†’ API Keys

### âŒ "Rate limit exceeded"
- Check your plan limits: http://localhost:2153/docs/rate-limits
- Implement exponential backoff
- Consider upgrading your plan

### âŒ "No active WhatsApp connection"
- Connect a device: Settings â†’ Devices
- Verify device status is "connected"

---

## ğŸ‰ You're Ready!

You've successfully:
- âœ… Created an API key
- âœ… Tested the API
- âœ… Sent a message

**What's next?**
- Integrate with your accounting software
- Set up webhooks for real-time updates
- Build custom automations
- Scale your WhatsApp operations

**Need help?** Check the full documentation at http://localhost:2153/docs

---

**Happy coding! ğŸš€**

