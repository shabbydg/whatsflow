# WhatsFlow Billing System - Testing Guide

**Phase:** 2A + 2B Complete  
**Status:** Ready for End-to-End Testing

---

## Prerequisites

### 1. Database Setup

```bash
cd /Users/digitalarc/Development/Webroot/whatsflow/whatsflow/backend

# Run migrations
mysql -u root whatsflow < migrations/create_billing_system.sql
mysql -u root whatsflow < migrations/seed_plans.sql
```

**Important:** Before running `seed_plans.sql`, generate admin password:

```bash
# Generate bcrypt hash for password "Admin@123"
node -e "const bcrypt = require('bcryptjs'); console.log(bcrypt.hashSync('Admin@123', 10));"

# Copy the output and replace line 132 in seed_plans.sql:
# OLD: '$2a$10$rQ8Ks9LhFxEKxK5K5K5K5OeKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK'
# NEW: 'YOUR_GENERATED_HASH_HERE'
```

### 2. PayHere Account Setup

See `PAYHERE_SETUP_GUIDE.md` for detailed instructions.

**Quick version:**
1. Go to https://www.payhere.lk/
2. Register sandbox account
3. Get Merchant ID & Secret
4. Create API Keys
5. Add credentials to `.env`

### 3. Environment Variables

Edit `/whatsflow/backend/.env`:

```env
# PayHere (replace with your credentials)
PAYHERE_MERCHANT_ID=1234567
PAYHERE_MERCHANT_SECRET=your_secret_here
PAYHERE_APP_ID=your_app_id
PAYHERE_APP_SECRET=your_app_secret
PAYHERE_MODE=sandbox

# URLs
PAYHERE_RETURN_URL=http://localhost:2153/billing/success
PAYHERE_CANCEL_URL=http://localhost:2153/billing/cancel
PAYHERE_NOTIFY_URL=http://localhost:2152/api/v1/billing/webhook
```

---

## Test Scenarios

(continues with all 509 lines of the original TESTING_GUIDE.md)

